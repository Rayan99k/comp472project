# COMP 472 CIFAR-10 Image Classification
## Contents
- <ins>**load_dataset.py**</ins>: Loads and preprocesses the CIFAR-10 dataset, resizing images and selecting a fixed number of samples per class for training and testing.
- <ins>**feature_extraction.py**</ins>: Extracts feature vectors from the CIFAR-10 dataset using a pre-trained ResNet-18 model and saves them for further processing.

- <ins>**naive_bayes.py**</ins>: Provides custom and Scikit-learn implementations of the Gaussian Naive Bayes algorithm, including model saving and evaluation functionalitiesâ€‹.
- <ins>**decision_tree.py**</ins>: Implements both custom and Scikit-learn decision tree classifiers with support for saving, loading, and evaluating models at varying depths.
- <ins>**mlp.py**</ins>: Implements and trains Multi-Layer Perceptron (MLP) models of varying depths and evaluates their performance.
- <ins>**vgg11_experiment_kernel.py**</ins>: Tests the effect of varying convolutional kernel sizes in a VGG11-based CNN on model performance and computational costs.
- <ins>**vgg11_experiment_layers**</ins>: Tests the effect of adding or removing layers in a VGG11-based CNN on model performance and computational costs.
- <ins>**data/**</ins>: Data generated by load_dataset.py is stored in this directory.
- <ins>**models/**</ins>: Models trained by various algorithms are stored in this directory.
    - Please note that these two directories were unable to be uploaded even when attempting to use Github LFS, and Moodle's maximum file size is 250 MB. I have uploaded them to Google Drive, [click here to download](https://drive.google.com/drive/folders/1uCgOw3bmyu_rhGk4u6UZvollaSTzUj_I?usp=sharing)

## Data Pre-Processing
Steps to Pre-Process the Data:
1. Run load_dataset.py
- Verify that a new directory "/data" was created in the current directory.
- The terminal should output:
    - Training Set: 5000 images
    - Test Set: 1000 images
2. Run feature_extraction.py
  - Verify that the following files are created in the current directory:
    - train_features.pt
    - test_features.pt
    - train_features.npy
    - train_labels.npy
    - test_features.npy
    - test_labels.npy

## Training and Evaluation
### Steps to Train/Evaluate the Models:
* Naive Bayes - <ins>**naive_bayes.py**</ins>:
  - Run Program
  - If you do not have the correct _.pkl_ model, you will have to wait for training to complete. If you have it, you will be prompted with:
    - Custom model 'models/model_configuration.pkl' exists. Load it? (y/n): **__y__**
  - If you enter **__n__**, it will begin training automatically.
  - The custom implementation evaluation is displayed in the terminal, followed by the Scikit-learn evaluation.
* Decision Tree - <ins>**decision_tree.py**</ins>:
  - Run Program
  - You will be prompted with:
    - Enter the desired tree depth (e.g., 10, 25, 50): **__e.g. 10__**
  - Here you can enter any desired depth, but for this project only depths 10, 25, and 50 were trained.
  - If you do not have the correct _.pkl_ model, you will have to wait for training to complete. If you have it, you will be prompted with:
    - Custom model 'models/model_configuration.pkl' exists. Load it? (y/n): e.g. **__y__**
  - If you enter **__n__**, it will begin training automatically.
  - The custom implementation evaluation is displayed in the terminal, followed by the Scikit-learn evaluation.
* MLP - <ins>**mlp.py**</ins>:
  - Run Program
  - If you do not have the correct _.pkl_ model, you will have to wait for training to complete. If you have it, you will be prompted with:
    - Custom model 'models/model_configuration.pkl' exists. Load it? (y/n): **__y__**
  - If you enter **__n__**, it will begin training automatically.
  - Please note that you will be prompted after each MLP module to load the next configuration for a total of 3 prompts.
  - The shortened MLP evaluation is displayed in the terminal, followed by the base and extended MLP evaluations.
* CNN - <ins>**vgg11_experiment_kernel.py**</ins>:
  - _Optional: follow the comment on line 40 to adjust the kernel size, please note that the model was only trained on the default settings due to a lack of time_ 
  - Run Program
  - If you do not have the correct _.pkl_ model, you will have to wait for training to complete. If you have it, you will be prompted with:
    - Custom model 'models/model_configuration.pkl' exists. Load it? (y/n): **__y__**
  - If you enter **__n__**, it will begin training automatically.
  - The CNN evaluation is displayed in the terminal.
* CNN - <ins>**vgg11_experiment_layers.py**</ins>:
  - This file is there but did not have time to complete training. Please dismiss.

## Notes
No other dependencies other than what is listed on the project sheet should be required to run this project.
